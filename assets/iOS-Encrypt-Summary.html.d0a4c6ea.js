import{r as t,o as l,c as i,a as n,e as a,F as p,d as r,b as s}from"./app.01142347.js";import{_ as b}from"./plugin-vue_export-helper.21dcd24c.js";const c={},u=r(`<h3 id="ios\u5E38\u89C1\u52A0\u5BC6\u7B97\u6CD5\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#ios\u5E38\u89C1\u52A0\u5BC6\u7B97\u6CD5\u603B\u7ED3" aria-hidden="true">#</a> iOS\u5E38\u89C1\u52A0\u5BC6\u7B97\u6CD5\u603B\u7ED3</h3><h4 id="_1-\u5B89\u5168\u6563\u5217\u7B97\u6CD5" tabindex="-1"><a class="header-anchor" href="#_1-\u5B89\u5168\u6563\u5217\u7B97\u6CD5" aria-hidden="true">#</a> <a href="#Secure-Hash-Algorithm">1. \u5B89\u5168\u6563\u5217\u7B97\u6CD5</a></h4><blockquote><p><strong>Secure Hash Algorithm</strong>\uFF0C\u5E38\u89C1\u7684\u7B97\u6CD5\u5305\u62EC\u4E86 <strong><a href="#md5">MD5</a></strong>\u3001<strong><a href="#SHA">SHA1</a></strong>\u3001<strong><a href="#HMAC">HMAC</a></strong> \u7B49\u3002</p></blockquote><blockquote><p>\u5C06\u4EFB\u610F\u957F\u5EA6\u7684\u4E8C\u8FDB\u5236\u503C\u6620\u5C04\u4E3A\u8F83\u77ED\u7684\u56FA\u5B9A\u957F\u5EA6\u7684\u4E8C\u8FDB\u5236\u503C\uFF0C\u8FD9\u4E2A\u77ED\u7684\u4E8C\u8FDB\u5236\u503C\u79F0\u4E3A\u54C8\u5E0C\u503C\uFF0C\u8FD9\u4E2A\u7B97\u6CD5\u5177\u6709\u4E0D\u53EF\u9006\u3001\u78B0\u649E\u4F4E\u7B49\u7279\u6027\u3002\u540C\u65F6\u8BE5\u7C7B\u7B97\u6CD5\u53EF\u4EE5\u7528\u4F5C\u6570\u5B57\u7B7E\u540D\uFF0C\u7528\u6765\u8BC1\u5B9E\u67D0\u4E2A\u4FE1\u606F\u786E\u5B9E\u662F\u7531\u67D0\u4E2A\u4EBA\u53D1\u51FA\u7684\uFF0C\u540C\u65F6\u53EF\u4EE5\u4FDD\u8BC1\u4FE1\u606F\u6CA1\u6709\u88AB\u4FEE\u6539\u3002</p></blockquote><blockquote><p>\u5B9E\u9645\u4E0A\uFF0C\u7B80\u5355\u6765\u8BF4\uFF0C\u8FD9\u79CD\u7B97\u6CD5\u6709\u4E24\u4E2A\u7279\u6027\uFF1A</p><p>A) \u4E0D\u540C\u7684\u8F93\u5165\u4E00\u5B9A\u5F97\u51FA\u4E0D\u540C\u7684 hash \u503C\uFF1B</p><p>B) \u65E0\u6CD5\u4ECE hash \u503C\u5012\u63A8\u51FA\u539F\u6765\u7684\u8F93\u5165\u3002</p></blockquote><h4 id="_2-\u5BF9\u79F0\u52A0\u5BC6" tabindex="-1"><a class="header-anchor" href="#_2-\u5BF9\u79F0\u52A0\u5BC6" aria-hidden="true">#</a> <a href="#symmetric-key-encryption">2. \u5BF9\u79F0\u52A0\u5BC6</a></h4><blockquote><p><strong>symmetric-key encryption</strong>\uFF0C\u5176\u4E2D\u5E38\u89C1\u7684\u7B97\u6CD5\u5305\u62EC\u4E86 <strong><a href="#AES">AES</a></strong>\u3001<strong><a href="#DES">DES</a></strong>\u3001<strong>3DES</strong>\u3001<strong><a href="#RC4">RC4</a></strong> \u7B49\u3002</p></blockquote><blockquote><p>\u5BF9\u79F0\u52A0\u5BC6\u6307\u7684\u662F\u53EF\u4EE5\u4F7F\u7528\u540C\u4E00\u4E2A\u5BC6\u94A5\u5BF9\u5185\u5BB9\u8FDB\u884C\u52A0\u5BC6\u548C\u89E3\u5BC6\uFF0C\u76F8\u6BD4\u975E\u5BF9\u79F0\u52A0\u5BC6\uFF0C\u5B83\u7684\u7279\u70B9\u662F\u52A0/\u89E3\u5BC6\u901F\u5EA6\u5FEB\uFF0C\u5E76\u4E14\u52A0\u5BC6\u7684\u5185\u5BB9\u957F\u5EA6\u51E0\u4E4E\u6CA1\u6709\u9650\u5236\u3002</p></blockquote><h4 id="_3-\u975E\u5BF9\u79F0\u52A0\u5BC6" tabindex="-1"><a class="header-anchor" href="#_3-\u975E\u5BF9\u79F0\u52A0\u5BC6" aria-hidden="true">#</a> <a href="#asymmetric-public-key-encryption">3. \u975E\u5BF9\u79F0\u52A0\u5BC6</a></h4><blockquote><p><strong>asymmetric/public-key encryption</strong>\uFF0C\u5E38\u89C1\u7684\u52A0\u5BC6\u7B97\u6CD5\u6709 <strong><a href="#RSA">RSA</a></strong>\u3001<strong>DSA</strong>\u3001<strong>ECC</strong> \u7B49\u3002</p></blockquote><blockquote><p>\u975E\u5BF9\u79F0\u52A0\u5BC6\u6709\u4E24\u4E2A\u5BC6\u94A5\uFF0C\u5206\u522B\u4E3A\u516C\u94A5\u548C\u79C1\u94A5\uFF0C\u5176\u4E2D\u516C\u94A5\u516C\u5F00\u7ED9\u6240\u6709\u4EBA\uFF0C\u79C1\u94A5\u6C38\u8FDC\u53EA\u80FD\u81EA\u5DF1\u77E5\u9053\u3002</p></blockquote><blockquote><p>\u4F7F\u7528\u516C\u94A5\u52A0\u5BC6\u7684\u4FE1\u606F\u53EA\u80FD\u4F7F\u7528\u79C1\u94A5\u89E3\u5BC6\uFF0C\u4F7F\u7528\u79C1\u94A5\u52A0\u5BC6\u53EA\u80FD\u4F7F\u7528\u516C\u94A5\u89E3\u5BC6\u3002\u524D\u8005\u7528\u6765\u4F20\u8F93\u9700\u8981\u4FDD\u5BC6\u7684\u4FE1\u606F\uFF0C\u56E0\u4E3A\u5168\u4E16\u754C\u53EA\u6709\u77E5\u9053\u5BF9\u5E94\u79C1\u94A5\u7684\u4EBA\u624D\u53EF\u4EE5\u89E3\u5BC6\uFF1B\u540E\u8005\u7528\u6765\u4F5C\u6570\u5B57\u7B7E\u540D\uFF0C\u56E0\u4E3A\u516C\u94A5\u5BF9\u6240\u6709\u4EBA\u516C\u5F00\u7684\uFF0C\u53EF\u4EE5\u7528\u6765\u786E\u8BA4\u8FD9\u4E2A\u4FE1\u606F\u662F\u5426\u662F\u4ECE\u79C1\u94A5\u7684\u62E5\u6709\u8005\u53D1\u51FA\u7684\u3002</p></blockquote><h3 id="\u5B89\u5168\u6563\u5217\u7B97\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u5B89\u5168\u6563\u5217\u7B97\u6CD5" aria-hidden="true">#</a> <a name="Secure-Hash-Algorithm"></a>\u5B89\u5168\u6563\u5217\u7B97\u6CD5</h3><p><strong><a name="md5"></a>MD5\u4FE1\u606F\u6458\u8981</strong></p><blockquote><p><strong>MD5 Message-Digest Algorithm</strong>\uFF0C\u4E00\u79CD\u88AB\u5E7F\u6CDB\u4F7F\u7528\u7684\u5BC6\u7801\u6563\u5217\u51FD\u6570\uFF0C\u53EF\u4EE5\u4EA7\u751F\u51FA\u4E00\u4E2A128\u4F4D\uFF0816\u5B57\u8282\uFF09\u7684\u6563\u5217\u503C\uFF08hash value\uFF09\uFF0C\u7528\u4E8E\u786E\u4FDD\u4FE1\u606F\u4F20\u8F93\u5B8C\u6574\u4E00\u81F4\u3002</p><p>MD5\u7531\u7F8E\u56FD\u5BC6\u7801\u5B66\u5BB6\u7F57\u7EB3\u5FB7\xB7\u674E\u7EF4\u65AF\u7279\uFF08Ronald Linn Rivest\uFF09\u8BBE\u8BA1\uFF0C\u4E8E1992\u5E74\u516C\u5F00\uFF0C\u7528\u4EE5\u53D6\u4EE3MD4\u7B97\u6CD5\u3002</p><p>\u5C06\u6570\u636E\uFF08\u5982\u4E00\u6BB5\u6587\u5B57\uFF09\u8FD0\u7B97\u53D8\u4E3A\u53E6\u4E00\u56FA\u5B9A\u957F\u5EA6\u503C\uFF0C\u662F\u6563\u5217\u7B97\u6CD5\u7684\u57FA\u7840\u539F\u7406\u3002</p><p>1996\u5E74\u540E\u88AB\u8BC1\u5B9E\u5B58\u5728\u5F31\u70B9\uFF0C\u53EF\u4EE5\u88AB\u52A0\u4EE5\u7834\u89E3\uFF0C\u5BF9\u4E8E\u9700\u8981\u9AD8\u5EA6\u5B89\u5168\u6027\u7684\u6570\u636E\uFF0C\u4E13\u5BB6\u4E00\u822C\u5EFA\u8BAE\u6539\u7528\u5176\u4ED6\u7B97\u6CD5\uFF0C\u5982SHA-2\u30022004\u5E74\uFF0C\u8BC1\u5B9EMD5\u7B97\u6CD5\u65E0\u6CD5\u9632\u6B62\u78B0\u649E\uFF08collision\uFF09\uFF0C\u56E0\u6B64\u4E0D\u9002\u7528\u4E8E\u5B89\u5168\u6027\u8BA4\u8BC1\uFF0C\u5982SSL\u516C\u5F00\u5BC6\u94A5\u8BA4\u8BC1\u6216\u662F\u6570\u5B57\u7B7E\u540D\u7B49\u7528\u9014\u3002</p></blockquote><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>#include &lt;CommonCrypto/CommonCrypto.h&gt;

@implementation NSData (Add)

- (NSString *)md5String {
    unsigned char result[CC_MD5_DIGEST_LENGTH];
    CC_MD5(self.bytes, (CC_LONG)self.length, result);
    NSMutableString *hash = [NSMutableString string];
    for (int i = 0; i &lt; CC_MD5_DIGEST_LENGTH; i++) {
        [hash appendFormat:@&quot;%02x&quot;, result[i]];
    }
    return hash;
}
@end
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="sha\u5BB6\u65CF" tabindex="-1"><a class="header-anchor" href="#sha\u5BB6\u65CF" aria-hidden="true">#</a> <a name="SHA"></a>SHA\u5BB6\u65CF</h3><blockquote><p><strong>\u5B89\u5168\u6563\u5217\u7B97\u6CD5</strong>\uFF08\u82F1\u8BED\uFF1ASecure Hash Algorithm\uFF0C\u7F29\u5199\u4E3ASHA\uFF09\u662F\u4E00\u4E2A\u5BC6\u7801\u6563\u5217\u51FD\u6570\u5BB6\u65CF\uFF0C\u662FFIPS\u6240\u8BA4\u8BC1\u7684\u5B89\u5168\u6563\u5217\u7B97\u6CD5\u3002 \u80FD\u8BA1\u7B97\u51FA\u4E00\u4E2A\u6570\u5B57\u6D88\u606F\u6240\u5BF9\u5E94\u5230\u7684\uFF0C\u957F\u5EA6\u56FA\u5B9A\u7684\u5B57\u7B26\u4E32\uFF08\u53C8\u79F0\u6D88\u606F\u6458\u8981\uFF09\u7684\u7B97\u6CD5\u3002\u4E14\u82E5\u8F93\u5165\u7684\u6D88\u606F\u4E0D\u540C\uFF0C\u5B83\u4EEC\u5BF9\u5E94\u5230\u4E0D\u540C\u5B57\u7B26\u4E32\u7684\u673A\u7387\u5F88\u9AD8\u3002 SHA\u5BB6\u65CF\u7684\u7B97\u6CD5\uFF0C\u7531\u7F8E\u56FD\u56FD\u5BB6\u5B89\u5168\u5C40\uFF08NSA\uFF09\u6240\u8BBE\u8BA1\uFF0C\u5E76\u7531\u7F8E\u56FD\u56FD\u5BB6\u6807\u51C6\u4E0E\u6280\u672F\u7814\u7A76\u9662\uFF08NIST\uFF09\u53D1\u5E03\uFF0C\u662F\u7F8E\u56FD\u7684\u653F\u5E9C\u6807\u51C6\uFF0C\u5176\u5206\u522B\u662F\uFF1A</p></blockquote><blockquote><p><strong>SHA-0</strong>\uFF1A1993\u5E74\u53D1\u5E03\uFF0C\u5F53\u65F6\u79F0\u505A\u5B89\u5168\u6563\u5217\u6807\u51C6\uFF08Secure Hash Standard\uFF09\uFF0C\u53D1\u5E03\u4E4B\u540E\u5F88\u5FEB\u5C31\u88ABNSA\u64A4\u56DE\uFF0C\u662FSHA-1\u7684\u524D\u8EAB\u3002</p></blockquote><blockquote><p><strong>SHA-1</strong>\uFF1A1995\u5E74\u53D1\u5E03\uFF0CSHA-1\u5728\u8BB8\u591A\u5B89\u5168\u534F\u8BAE\u4E2D\u5E7F\u4E3A\u4F7F\u7528\uFF0C\u5305\u62ECTLS\u548CSSL\u3001PGP\u3001SSH\u3001S/MIME\u548CIPsec\uFF0C\u66FE\u88AB\u89C6\u4E3A\u662FMD5\uFF08\u66F4\u65E9\u4E4B\u524D\u88AB\u5E7F\u4E3A\u4F7F\u7528\u7684\u6563\u5217\u51FD\u6570\uFF09\u7684\u540E\u7EE7\u8005\u3002\u4F46SHA-1\u7684\u5B89\u5168\u6027\u57282000\u5E74\u4EE5\u540E\u5DF2\u7ECF\u4E0D\u88AB\u5927\u591A\u6570\u7684\u52A0\u5BC6\u573A\u666F\u6240\u63A5\u53D7\u3002 2017\u5E74\u8377\u5170\u5BC6\u7801\u5B66\u7814\u7A76\u5C0F\u7EC4CWI\u548CGoogle\u6B63\u5F0F\u5BA3\u5E03\u653B\u7834\u4E86SHA-1\u3002</p></blockquote><blockquote><p><strong>SHA-2</strong>\uFF1A2001\u5E74\u53D1\u5E03\uFF0C\u5305\u62ECSHA-224\u3001SHA-256\u3001SHA-384\u3001SHA-512\u3001SHA-512/224\u3001SHA-512/256\u3002 \u867D\u7136\u81F3\u4ECA\u5C1A\u672A\u51FA\u73B0\u5BF9SHA-2\u6709\u6548\u7684\u653B\u51FB\uFF0C\u5B83\u7684\u7B97\u6CD5\u8DDFSHA-1\u57FA\u672C\u4E0A\u4ECD\u7136\u76F8\u4F3C\uFF1B\u56E0\u6B64\u6709\u4E9B\u4EBA\u5F00\u59CB\u53D1\u5C55\u5176\u4ED6\u66FF\u4EE3\u7684\u6563\u5217\u7B97\u6CD5\u3002</p></blockquote><blockquote><p><strong>SHA-3</strong>\uFF1A2015\u5E74\u6B63\u5F0F\u53D1\u5E03\uFF0CSHA-3\u5E76\u4E0D\u662F\u8981\u53D6\u4EE3SHA-2\uFF0C\u56E0\u4E3ASHA-2\u76EE\u524D\u5E76\u6CA1\u6709\u51FA\u73B0\u660E\u663E\u7684\u5F31\u70B9\u3002 \u7531\u4E8E\u5BF9MD5\u51FA\u73B0\u6210\u529F\u7684\u7834\u89E3\uFF0C\u4EE5\u53CA\u5BF9SHA-0\u548CSHA-1\u51FA\u73B0\u7406\u8BBA\u4E0A\u7834\u89E3\u7684\u65B9\u6CD5\uFF0CNIST\u611F\u89C9\u9700\u8981\u4E00\u4E2A\u4E0E\u4E4B\u524D\u7B97\u6CD5\u4E0D\u540C\u7684\uFF0C\u53EF\u66FF\u6362\u7684\u52A0\u5BC6\u6563\u5217\u7B97\u6CD5\uFF0C\u4E5F\u5C31\u662F\u73B0\u5728\u7684SHA-3\u3002</p></blockquote><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>#include &lt;CommonCrypto/CommonCrypto.h&gt;

@implementation NSData (Add)

- (NSString *)sha1String {
    unsigned char result[CC_SHA1_DIGEST_LENGTH];
    CC_SHA1(self.bytes, (CC_LONG)self.length, result);
    NSMutableString *hash = [NSMutableString stringWithCapacity:CC_SHA1_DIGEST_LENGTH * 2];
    for (int i = 0; i &lt; CC_SHA1_DIGEST_LENGTH; i++) {
        [hash appendFormat:@&quot;%02x&quot;, result[i]];
    }
    return hash;
}

- (NSString *)sha224String {
    unsigned char result[CC_SHA224_DIGEST_LENGTH];
    CC_SHA224(self.bytes, (CC_LONG)self.length, result);
    NSMutableString *hash = [NSMutableString
                             stringWithCapacity:CC_SHA224_DIGEST_LENGTH * 2];
    for (int i = 0; i &lt; CC_SHA224_DIGEST_LENGTH; i++) {
        [hash appendFormat:@&quot;%02x&quot;, result[i]];
    }
    return hash;
}

- (NSString *)sha256String {
    unsigned char result[CC_SHA256_DIGEST_LENGTH];
    CC_SHA256(self.bytes, (CC_LONG)self.length, result);
    NSMutableString *hash = [NSMutableString
                             stringWithCapacity:CC_SHA256_DIGEST_LENGTH * 2];
    for (int i = 0; i &lt; CC_SHA256_DIGEST_LENGTH; i++) {
        [hash appendFormat:@&quot;%02x&quot;, result[i]];
    }
    return hash;
}

- (NSString *)sha384String {
    unsigned char result[CC_SHA384_DIGEST_LENGTH];
    CC_SHA384(self.bytes, (CC_LONG)self.length, result);
    NSMutableString *hash = [NSMutableString
                             stringWithCapacity:CC_SHA384_DIGEST_LENGTH * 2];
    for (int i = 0; i &lt; CC_SHA384_DIGEST_LENGTH; i++) {
        [hash appendFormat:@&quot;%02x&quot;, result[i]];
    }
    return hash;
}

- (NSString *)sha512String {
    unsigned char result[CC_SHA512_DIGEST_LENGTH];
    CC_SHA512(self.bytes, (CC_LONG)self.length, result);
    NSMutableString *hash = [NSMutableString
                             stringWithCapacity:CC_SHA512_DIGEST_LENGTH * 2];
    for (int i = 0; i &lt; CC_SHA512_DIGEST_LENGTH; i++) {
        [hash appendFormat:@&quot;%02x&quot;, result[i]];
    }
    return hash;
}

@end
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><h3 id="hmac" tabindex="-1"><a class="header-anchor" href="#hmac" aria-hidden="true">#</a> <a name="HMAC"></a>HMAC</h3><blockquote><p>HMAC\u52A0\u5BC6\u7B97\u6CD5\u662F\u4E00\u79CD\u5B89\u5168\u7684\u57FA\u4E8E\u52A0\u5BC6hash\u51FD\u6570\u548C\u5171\u4EAB\u5BC6\u94A5\u7684\u6D88\u606F\u8BA4\u8BC1\u534F\u8BAE\uFF0E \u5B83\u53EF\u4EE5\u6709\u6548\u5730\u9632\u6B62\u6570\u636E\u5728\u4F20\u8F93\u8FC7\u7A0B\u4E2D\u88AB\u622A\u83B7\u548C\u7BE1\u6539\uFF0C\u7EF4\u62A4\u4E86\u6570\u636E\u7684\u5B8C\u6574\u6027\u3001\u53EF\u9760\u6027\u548C\u5B89\u5168\u6027. HMAC\u52A0\u5BC6\u7B97\u6CD5\u662F\u4E00\u79CD\u57FA\u4E8E\u5BC6\u94A5\u7684\u62A5\u6587\u5B8C\u6574\u6027\u7684\u9A8C\u8BC1\u65B9\u6CD5\uFF0C\u5176\u5B89\u5168\u6027\u662F\u5EFA\u7ACB\u5728Hash\u52A0\u5BC6\u7B97\u6CD5\u57FA\u7840\u4E0A\u7684</p></blockquote>`,25),o={href:"https://en.wikipedia.org/wiki/HMAC",target:"_blank",rel:"noopener noreferrer"},m=s("HMAC \u7EF4\u57FA\u767E\u79D1"),S=r(`<div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>#include &lt;CommonCrypto/CommonCrypto.h&gt;

@implementation NSData (Add)


- (NSString *)hmacStringUsingAlg:(CCHmacAlgorithm)alg withKey:(NSString *)key {
    size_t size;
    switch (alg) {
        case kCCHmacAlgMD5: size = CC_MD5_DIGEST_LENGTH; break;
        case kCCHmacAlgSHA1: size = CC_SHA1_DIGEST_LENGTH; break;
        case kCCHmacAlgSHA224: size = CC_SHA224_DIGEST_LENGTH; break;
        case kCCHmacAlgSHA256: size = CC_SHA256_DIGEST_LENGTH; break;
        case kCCHmacAlgSHA384: size = CC_SHA384_DIGEST_LENGTH; break;
        case kCCHmacAlgSHA512: size = CC_SHA512_DIGEST_LENGTH; break;
        default: return nil;
    }
    unsigned char result[size];
    const char *cKey = [key cStringUsingEncoding:NSUTF8StringEncoding];
    CCHmac(alg, cKey, strlen(cKey), self.bytes, self.length, result);
    NSMutableString *hash = [NSMutableString stringWithCapacity:size * 2];
    for (int i = 0; i &lt; size; i++) {
        [hash appendFormat:@&quot;%02x&quot;, result[i]];
    }
    return hash;
}

- (NSString *)hmacMD5StringWithKey:(NSString *)key {
    return [self hmacStringUsingAlg:kCCHmacAlgMD5 withKey:key];
}


- (NSString *)hmacSHA1StringWithKey:(NSString *)key {
    return [self hmacStringUsingAlg:kCCHmacAlgSHA1 withKey:key];
}


- (NSString *)hmacSHA224StringWithKey:(NSString *)key {
    return [self hmacStringUsingAlg:kCCHmacAlgSHA224 withKey:key];
}


- (NSString *)hmacSHA256StringWithKey:(NSString *)key {
    return [self hmacStringUsingAlg:kCCHmacAlgSHA256 withKey:key];
}


- (NSString *)hmacSHA384StringWithKey:(NSString *)key {
    return [self hmacStringUsingAlg:kCCHmacAlgSHA384 withKey:key];
}


- (NSString *)hmacSHA512StringWithKey:(NSString *)key {
    return [self hmacStringUsingAlg:kCCHmacAlgSHA512 withKey:key];
}

@end
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br></div></div><h3 id="\u5BF9\u79F0\u52A0\u5BC6" tabindex="-1"><a class="header-anchor" href="#\u5BF9\u79F0\u52A0\u5BC6" aria-hidden="true">#</a> <a name="symmetric-key-encryption"></a>\u5BF9\u79F0\u52A0\u5BC6</h3><h4 id="aes" tabindex="-1"><a class="header-anchor" href="#aes" aria-hidden="true">#</a> <a name="AES"></a>AES</h4><blockquote><p>\u9AD8\u7EA7\u52A0\u5BC6\u6807\u51C6\uFF0C\u5728\u5BC6\u7801\u5B66\u4E2D\u53C8\u79F0Rijndael\u52A0\u5BC6\u6CD5\uFF0C\u662F\u7F8E\u56FD\u8054\u90A6\u653F\u5E9C\u91C7\u7528\u7684\u4E00\u79CD\u533A\u5757\u52A0\u5BC6\u6807\u51C6\u3002\u8FD9\u4E2A\u6807\u51C6\u7528\u6765\u66FF\u4EE3\u539F\u5148\u7684DES\uFF0C\u5DF2\u7ECF\u88AB\u591A\u65B9\u5206\u6790\u4E14\u5E7F\u4E3A\u5168\u4E16\u754C\u6240\u4F7F\u7528\u3002\u7ECF\u8FC7\u4E94\u5E74\u7684\u7504\u9009\u6D41\u7A0B\uFF0C\u9AD8\u7EA7\u52A0\u5BC6\u6807\u51C6\u7531\u7F8E\u56FD\u56FD\u5BB6\u6807\u51C6\u4E0E\u6280\u672F\u7814\u7A76\u9662\u4E8E2001\u5E7411\u670826\u65E5\u53D1\u5E03\u4E8EFIPS PUB 197\uFF0C\u5E76\u57282002\u5E745\u670826\u65E5\u6210\u4E3A\u6709\u6548\u7684\u6807\u51C6.</p></blockquote><p>\u5BC6\u7801\u8BF4\u660E</p><blockquote><p>\u4E25\u683C\u5730\u8BF4\uFF0C<code>AES</code>\u548C<code>Rijndael</code>\u52A0\u5BC6\u6CD5\u5E76\u4E0D\u5B8C\u5168\u4E00\u6837\uFF08\u867D\u7136\u5728\u5B9E\u9645\u5E94\u7528\u4E2D\u4E24\u8005\u53EF\u4EE5\u4E92\u6362\uFF09\uFF0C\u56E0\u4E3A<code>Rijndael</code>\u52A0\u5BC6\u6CD5\u53EF\u4EE5\u652F\u6301\u66F4\u5927\u8303\u56F4\u7684\u533A\u5757\u548C\u5BC6\u94A5\u957F\u5EA6\uFF1A<code>AES</code>\u7684\u533A\u5757\u957F\u5EA6\u56FA\u5B9A\u4E3A128\u6BD4\u7279\uFF0C\u5BC6\u94A5\u957F\u5EA6\u5219\u53EF\u4EE5\u662F128\uFF0C192\u6216256\u6BD4\u7279\uFF1B\u800C<code>Rijndael</code>\u4F7F\u7528\u7684\u5BC6\u94A5\u548C\u533A\u5757\u957F\u5EA6\u5747\u53EF\u4EE5\u662F128\uFF0C192\u6216256\u6BD4\u7279</p></blockquote><p>\u52A0/\u89E3\u5BC6NSData\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>#include &lt;CommonCrypto/CommonCrypto.h&gt;

@implementation NSData (Add)

- (NSData *)AES256EncryptWithKey:(NSData *)key iv:(NSData *)iv {
    if (key.length != 16 &amp;&amp; key.length != 24 &amp;&amp; key.length != 32) return nil;
    if (iv.length != 16 &amp;&amp; iv.length != 0) return nil;
    
    NSData *result = nil;
    size_t bufferSize = self.length + kCCBlockSizeAES128;
    void *buffer = malloc(bufferSize);
    if (!buffer) return nil;
    
    size_t encryptedSize = 0;
    CCCryptorStatus cryptStatus = CCCrypt(kCCEncrypt,
                                          kCCAlgorithmAES,
                                          kCCOptionPKCS7Padding,
                                          key.bytes,
                                          key.length,
                                          iv.bytes,
                                          self.bytes,
                                          self.length,
                                          buffer,
                                          bufferSize,
                                          &amp;encryptedSize);
    if (cryptStatus == kCCSuccess) {
        result = [[NSData alloc] initWithBytes:buffer length:(NSUInteger)encryptedSize];
        free(buffer);
        return result;
    } else {
        free(buffer);
        return nil;
    }
}

- (NSData *)AES256DecryptWithKey:(NSData *)key iv:(NSData *)iv {
    if (key.length != 16 &amp;&amp; key.length != 24 &amp;&amp; key.length != 32) return nil;
    if (iv.length != 16 &amp;&amp; iv.length != 0) return nil;
    
    NSData *result = nil;
    size_t bufferSize = self.length + kCCBlockSizeAES128;
    void *buffer = malloc(bufferSize);
    if (!buffer) return nil;
    
    size_t encryptedSize = 0;
    CCCryptorStatus cryptStatus = CCCrypt(kCCDecrypt,
                                          kCCAlgorithmAES,
                                          kCCOptionPKCS7Padding,
                                          key.bytes,
                                          key.length,
                                          iv.bytes,
                                          self.bytes,
                                          self.length,
                                          buffer,
                                          bufferSize,
                                          &amp;encryptedSize);
    if (cryptStatus == kCCSuccess) {
        result = [[NSData alloc] initWithBytes:buffer length:(NSUInteger)encryptedSize];
        free(buffer);
        return result;
    } else {
        free(buffer);
        return nil;
    }
}
@end
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br></div></div><p>\u52A0/\u89E3\u5BC6\u6587\u4EF6\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>
+ (NSString *)AESEncrypt:(NSString *)filePath withKey:(NSString *)key withIv:(NSString *)iv {
    
    NSString *content = [[NSString alloc] initWithContentsOfFile:filePath encoding:NSUTF8StringEncoding error:nil];
    
    NSData *data = [content dataUsingEncoding:NSUTF8StringEncoding];
    NSData *encryptData = [data AES256EncryptWithKey:[key dataUsingEncoding:NSUTF8StringEncoding] iv:[iv dataUsingEncoding:NSUTF8StringEncoding]];
    
    // convert to hex string
    return [self _hexStringFromData:encryptData];
}

+ (NSString *)AESDecrypt:(NSString *)filePath withKey:(NSString *)key withIv:(NSString *)iv {
    
    NSString *content = [[NSString alloc] initWithContentsOfFile:filePath encoding:NSUTF8StringEncoding error:nil];
    
    // convert hex string to NSData
    NSData *data = [self _dataFromHexString:content];
   
    NSData *result = [data AES256DecryptWithKey:[key dataUsingEncoding:NSUTF8StringEncoding] iv:[iv dataUsingEncoding:NSUTF8StringEncoding]];
    
    return [[NSString alloc] initWithData:result encoding:NSUTF8StringEncoding];
}

#pragma mark - Private Method

+ (NSString *)_hexStringFromData:(NSData *)data {
    Byte *bytes = (Byte *)[data bytes];
    NSMutableString *output = [NSMutableString stringWithCapacity:data.length * 2];
    for (int i = 0; i &lt; data.length; i++) {
        [output appendFormat:@&quot;%02x&quot;, bytes[i]];
    }
    return output;
}

+ (NSData *)_dataFromHexString:(NSString *)hexString {
    
    NSMutableData *data = [NSMutableData dataWithCapacity:hexString.length/2];
    unsigned char whole_byte;
    char byte_chars[3] = {&#39;\\0&#39;,&#39;\\0&#39;,&#39;\\0&#39;};
    int i;
    for (i=0; i &lt; [hexString length] / 2; i++) {
        byte_chars[0] = [hexString characterAtIndex:i*2];
        byte_chars[1] = [hexString characterAtIndex:i*2+1];
        whole_byte = strtol(byte_chars, NULL, 16);
        [data appendBytes:&amp;whole_byte length:1];
    }
    
    return data;
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><p><strong>\u53C2\u8003\uFF1A</strong></p>`,11),d={href:"https://www.zhihu.com/question/20874499",target:"_blank",rel:"noopener noreferrer"},g=s("RSA 1024\u548CAES 256\uFF0C\u8FD9\u4E24\u79CD\u52A0\u5BC6\u7B97\u6CD5\u7406\u8BBA\u4E0A\u54EA\u79CD\u66F4\u5B89\u5168\uFF1F"),h={href:"https://www.cnblogs.com/luop/p/4334160.html",target:"_blank",rel:"noopener noreferrer"},y=s("\u5BC6\u7801\u7B97\u6CD5\u8BE6\u89E3\u2014\u2014AES"),_={href:"https://zh.wikipedia.org/wiki/%E9%AB%98%E7%BA%A7%E5%8A%A0%E5%AF%86%E6%A0%87%E5%87%86",target:"_blank",rel:"noopener noreferrer"},f=s("\u9AD8\u7EA7\u52A0\u5BC6\u6807\u51C6"),k={href:"https://stackoverflow.com/questions/7317860/converting-hex-nsstring-to-nsdata",target:"_blank",rel:"noopener noreferrer"},N=s("converting hex nsstring to nsdata"),C=n("h4",{id:"des",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#des","aria-hidden":"true"},"#"),s(),n("a",{name:"DES"}),s("DES")],-1),A=n("strong",null,"\u6570\u636E\u52A0\u5BC6\u6807\u51C6",-1),E=s("\uFF08\u82F1\u8BED\uFF1AData Encryption Standard\uFF0C\u7F29\u5199\u4E3A DES\uFF09\u662F\u4E00\u79CD"),D={href:"https://zh.wikipedia.org/wiki/%E5%B0%8D%E7%A8%B1%E5%AF%86%E9%91%B0%E5%8A%A0%E5%AF%86",target:"_blank",rel:"noopener noreferrer"},K=s("\u5BF9\u79F0\u5BC6\u94A5\u52A0\u5BC6"),x={href:"https://zh.wikipedia.org/wiki/%E5%A1%8A%E5%AF%86%E7%A2%BC",target:"_blank",rel:"noopener noreferrer"},R=s("\u5757\u5BC6\u7801"),v=s("\u7B97\u6CD5\uFF0C1976\u5E74\u88AB"),H={href:"https://zh.wikipedia.org/wiki/%E7%BE%8E%E5%9B%BD",target:"_blank",rel:"noopener noreferrer"},q=s("\u7F8E\u56FD"),w=s("\u8054\u90A6\u653F\u5E9C\u7684"),T={href:"https://zh.wikipedia.org/wiki/%E5%9B%BD%E5%AE%B6%E6%A0%87%E5%87%86%E5%B1%80",target:"_blank",rel:"noopener noreferrer"},z=s("\u56FD\u5BB6\u6807\u51C6\u5C40"),B=s("\u786E\u5B9A\u4E3A"),F={href:"https://zh.wikipedia.org/wiki/%E8%81%94%E9%82%A6%E8%B5%84%E6%96%99%E5%A4%84%E7%90%86%E6%A0%87%E5%87%86",target:"_blank",rel:"noopener noreferrer"},O=s("\u8054\u90A6\u8D44\u6599\u5904\u7406\u6807\u51C6"),I=s("\uFF08FIPS\uFF09\uFF0C\u968F\u540E\u5728\u56FD\u9645\u4E0A\u5E7F\u6CDB\u6D41\u4F20\u5F00\u6765\u3002\u5B83\u57FA\u4E8E\u4F7F\u752856\u4F4D\u5BC6\u94A5\u7684"),U={href:"https://zh.wikipedia.org/w/index.php?title=%E5%AF%86%E9%92%A5%E5%AF%86%E7%A0%81%E5%AD%A6&action=edit&redlink=1",target:"_blank",rel:"noopener noreferrer"},G=s("\u5BF9\u79F0\u7B97\u6CD5"),M=s("\u3002\u8FD9\u4E2A\u7B97\u6CD5\u56E0\u4E3A\u5305\u542B\u4E00\u4E9B"),L={href:"https://zh.wikipedia.org/wiki/%E6%A9%9F%E5%AF%86",target:"_blank",rel:"noopener noreferrer"},W=s("\u673A\u5BC6"),P=s("\u8BBE\u8BA1\u5143\u7D20\uFF0C\u76F8\u5BF9\u77ED\u7684"),j={href:"https://zh.wikipedia.org/wiki/%E5%AF%86%E9%92%A5%E9%95%BF%E5%BA%A6",target:"_blank",rel:"noopener noreferrer"},V=s("\u5BC6\u94A5\u957F\u5EA6"),Z=s("\u4EE5\u53CA\u6000\u7591\u5185\u542B"),Y={href:"https://zh.wikipedia.org/wiki/%E7%BE%8E%E5%9C%8B%E5%9C%8B%E5%AE%B6%E5%AE%89%E5%85%A8%E5%B1%80",target:"_blank",rel:"noopener noreferrer"},X=s("\u7F8E\u56FD\u56FD\u5BB6\u5B89\u5168\u5C40"),J=s("\uFF08NSA\uFF09\u7684"),Q={href:"https://zh.wikipedia.org/wiki/%E5%90%8E%E9%97%A8",target:"_blank",rel:"noopener noreferrer"},$=s("\u540E\u95E8"),nn=s("\u800C\u5728\u5F00\u59CB\u65F6\u6709\u4E89\u8BAE\uFF0CDES\u56E0\u6B64\u53D7\u5230\u4E86\u5F3A\u70C8\u7684\u5B66\u9662\u6D3E\u5F0F\u7684\u5BA1\u67E5\uFF0C\u5E76\u4EE5\u6B64\u63A8\u52A8\u4E86\u73B0\u4EE3\u7684"),sn={href:"https://zh.wikipedia.org/wiki/%E5%A1%8A%E5%AF%86%E7%A2%BC",target:"_blank",rel:"noopener noreferrer"},en=s("\u5757\u5BC6\u7801"),an=s("\u53CA\u5176"),rn={href:"https://zh.wikipedia.org/wiki/%E5%AF%86%E7%A0%81%E5%88%86%E6%9E%90",target:"_blank",rel:"noopener noreferrer"},tn=s("\u5BC6\u7801\u5206\u6790"),ln=s("\u7684\u53D1\u5C55\u3002"),pn=r(`<p>iOS \u4EE3\u7801\u793A\u4F8B</p><div class="language-objective ext-objective line-numbers-mode"><pre class="language-objective"><code>+ (NSString *)base64EncodedStringWithData:(NSData *)data {
    return [data base64EncodedStringWithOptions:0];
}

+ (NSData *)base64DecodedDataWithString:(NSString *)string {
    return [self base64DecodedDataWithData:[string dataUsingEncoding:NSUTF8StringEncoding]];
}

+ (NSData *)base64DecodedDataWithData:(NSData *)data {
    return [[NSData alloc] initWithBase64EncodedData:data options:0];
}

// DES \u52A0\u5BC6
+ (NSString *)DESEncrypt:(NSString *)content withKey:(NSString *)key {
    NSData *data = [content dataUsingEncoding:NSUTF8StringEncoding];
    NSData *encryptedData = [self DESCrypt:data withKey:key withIV:nil operation:kCCEncrypt];
    return [self base64EncodedStringWithData:encryptedData];
}

// DES \u89E3\u5BC6
+ (NSString *)DESDecrypt:(NSString *)content withKey:(NSString *)key {
    NSData *encryptedData = [self base64DecodedDataWithString:content];
    NSData *decryptData = [self DESCrypt:encryptedData withKey:key withIV:nil operation:kCCDecrypt];
    return [[NSString alloc] initWithData:decryptData encoding:NSUTF8StringEncoding];
}

+ (NSData *)DESCrypt:(NSData *)contentData withKey:(NSString *)key withIV:(NSString *)iv operation:(CCOperation)operation {
    
    NSUInteger dataLength = contentData.length;
    
    const void *keyBytes = [key dataUsingEncoding:NSUTF8StringEncoding].bytes;
    const void *ivBytes = [iv dataUsingEncoding:NSUTF8StringEncoding].bytes;
    const void *contentBytes = contentData.bytes;
    
    size_t operationSize = dataLength + kCCBlockSizeDES;
    void *operationBytes = malloc(operationSize);
    if (operationBytes == NULL) return nil;
    
    size_t actualOutSize = 0;
    CCCryptorStatus status = CCCrypt(operation, kCCAlgorithmDES, kCCOptionPKCS7Padding | kCCOptionECBMode, keyBytes, kCCKeySizeDES, ivBytes, contentBytes, dataLength, operationBytes, operationSize, &amp;actualOutSize);
    
    NSData *outputData = nil;
    if (status == kCCSuccess) {
        outputData = [NSData dataWithBytes:operationBytes length:actualOutSize];
    }
    
    free(operationBytes);
    return outputData;
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><h4 id="rc4" tabindex="-1"><a class="header-anchor" href="#rc4" aria-hidden="true">#</a> <a name="RC4"></a>RC4</h4><blockquote><p><strong>Rivest Cipher 4</strong>\u662F\u4E00\u79CD\u6D41\u52A0\u5BC6\u7B97\u6CD5\uFF0C\u5BC6\u94A5\u957F\u5EA6\u53EF\u53D8\u3002\u5B83\u52A0\u89E3\u5BC6\u4F7F\u7528\u76F8\u540C\u7684\u5BC6\u94A5\uFF0C\u56E0\u6B64\u4E5F\u5C5E\u4E8E\u5BF9\u79F0\u52A0\u5BC6\u7B97\u6CD5\u3002</p></blockquote><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>#ifndef CX_SWAP // swap two value
#define CX_SWAP(_a_, _b_) do {__typeof__(_a_) _tmp_ = (_a_); (_a_) = (_b_); (_b_) = (_tmp_); } while(0)
#endif

@implementation NSString (CX)
- (NSString *)rc4WithKey:(NSString *)key {
    int j = 0;
    unichar res[self.length];
    const unichar *buffer = res;
    unsigned char s[256];
    for (int i = 0; i &lt; 256; i++) {
        s[i] = i;
    }
    for (int i = 0; i &lt; 256; i++) {
        j = (j + s[i] + [key characterAtIndex:(i%key.length)])%256;
        CX_SWAP(s[i], s[j]);
    }
    int i = j = 0;
    for (int y = 0; y &lt; self.length; y++) {
        i = (i + 1) % 256;
        j = (j + 1) % 256;
        CX_SWAP(s[i], s[j]);
        
        unsigned char f = [self characterAtIndex:y] ^ s[ (s[i] + s[j]) % 256 ];
        res[y] = f;
    }
    return [NSString stringWithCharacters:buffer length:self.length];
}
@end
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="\u975E\u5BF9\u79F0\u52A0\u5BC6" tabindex="-1"><a class="header-anchor" href="#\u975E\u5BF9\u79F0\u52A0\u5BC6" aria-hidden="true">#</a> <a name="asymmetric-public-key-encryption"></a>\u975E\u5BF9\u79F0\u52A0\u5BC6</h3><h4 id="rsa" tabindex="-1"><a class="header-anchor" href="#rsa" aria-hidden="true">#</a> <a name="RSA"></a>RSA</h4>`,7),bn=n("strong",null,"\u4EE5\u4E0B\u4EE3\u7801\u53C2\u8003\u81EA",-1),cn=s(),un={href:"https://github.com/ideawu/Objective-C-RSA",target:"_blank",rel:"noopener noreferrer"},on=s("Objective-C-RSA"),mn=r(`<div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>@interface RSA : NSObject

// return base64 encoded string
+ (NSString *)encryptString:(NSString *)str publicKey:(NSString *)pubKey;
// return raw data
+ (NSData *)encryptData:(NSData *)data publicKey:(NSString *)pubKey;
// return base64 encoded string
+ (NSString *)encryptString:(NSString *)str privateKey:(NSString *)privKey;
// return raw data
+ (NSData *)encryptData:(NSData *)data privateKey:(NSString *)privKey;

// decrypt base64 encoded string, convert result to string(not base64 encoded)
+ (NSString *)decryptString:(NSString *)str publicKey:(NSString *)pubKey;
+ (NSData *)decryptData:(NSData *)data publicKey:(NSString *)pubKey;
+ (NSString *)decryptString:(NSString *)str privateKey:(NSString *)privKey;
+ (NSData *)decryptData:(NSData *)data privateKey:(NSString *)privKey;

@end
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>#import &quot;RSA.h&quot;
#import &lt;Security/Security.h&gt;

@implementation RSA

static NSString *base64_encode_data(NSData *data){
	data = [data base64EncodedDataWithOptions:0];
	NSString *ret = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
	return ret;
}

static NSData *base64_decode(NSString *str){
	NSData *data = [[NSData alloc] initWithBase64EncodedString:str options:NSDataBase64DecodingIgnoreUnknownCharacters];
	return data;
}

+ (NSData *)stripPublicKeyHeader:(NSData *)d_key{
	// Skip ASN.1 public key header
	if (d_key == nil) return(nil);
	
	unsigned long len = [d_key length];
	if (!len) return(nil);
	
	unsigned char *c_key = (unsigned char *)[d_key bytes];
	unsigned int  idx	 = 0;
	
	if (c_key[idx++] != 0x30) return(nil);
	
	if (c_key[idx] &gt; 0x80) idx += c_key[idx] - 0x80 + 1;
	else idx++;
	
	// PKCS #1 rsaEncryption szOID_RSA_RSA
	static unsigned char seqiod[] =
	{ 0x30,   0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
		0x01, 0x05, 0x00 };
	if (memcmp(&amp;c_key[idx], seqiod, 15)) return(nil);
	
	idx += 15;
	
	if (c_key[idx++] != 0x03) return(nil);
	
	if (c_key[idx] &gt; 0x80) idx += c_key[idx] - 0x80 + 1;
	else idx++;
	
	if (c_key[idx++] != &#39;\\0&#39;) return(nil);
	
	// Now make a new NSData from this buffer
	return([NSData dataWithBytes:&amp;c_key[idx] length:len - idx]);
}

//credit: http://hg.mozilla.org/services/fx-home/file/tip/Sources/NetworkAndStorage/CryptoUtils.m#l1036
+ (NSData *)stripPrivateKeyHeader:(NSData *)d_key{
	// Skip ASN.1 private key header
	if (d_key == nil) return(nil);

	unsigned long len = [d_key length];
	if (!len) return(nil);

	unsigned char *c_key = (unsigned char *)[d_key bytes];
	unsigned int  idx	 = 22; //magic byte at offset 22

	if (0x04 != c_key[idx++]) return nil;

	//calculate length of the key
	unsigned int c_len = c_key[idx++];
	int det = c_len &amp; 0x80;
	if (!det) {
		c_len = c_len &amp; 0x7f;
	} else {
		int byteCount = c_len &amp; 0x7f;
		if (byteCount + idx &gt; len) {
			//rsa length field longer than buffer
			return nil;
		}
		unsigned int accum = 0;
		unsigned char *ptr = &amp;c_key[idx];
		idx += byteCount;
		while (byteCount) {
			accum = (accum &lt;&lt; 8) + *ptr;
			ptr++;
			byteCount--;
		}
		c_len = accum;
	}

	// Now make a new NSData from this buffer
	return [d_key subdataWithRange:NSMakeRange(idx, c_len)];
}

+ (SecKeyRef)addPublicKey:(NSString *)key{
	NSRange spos = [key rangeOfString:@&quot;-----BEGIN PUBLIC KEY-----&quot;];
	NSRange epos = [key rangeOfString:@&quot;-----END PUBLIC KEY-----&quot;];
	if(spos.location != NSNotFound &amp;&amp; epos.location != NSNotFound){
		NSUInteger s = spos.location + spos.length;
		NSUInteger e = epos.location;
		NSRange range = NSMakeRange(s, e-s);
		key = [key substringWithRange:range];
	}
	key = [key stringByReplacingOccurrencesOfString:@&quot;\\r&quot; withString:@&quot;&quot;];
	key = [key stringByReplacingOccurrencesOfString:@&quot;\\n&quot; withString:@&quot;&quot;];
	key = [key stringByReplacingOccurrencesOfString:@&quot;\\t&quot; withString:@&quot;&quot;];
	key = [key stringByReplacingOccurrencesOfString:@&quot; &quot;  withString:@&quot;&quot;];
	
	// This will be base64 encoded, decode it.
	NSData *data = base64_decode(key);
	data = [RSA stripPublicKeyHeader:data];
	if(!data){
		return nil;
	}

	//a tag to read/write keychain storage
	NSString *tag = @&quot;RSAUtil_PubKey&quot;;
	NSData *d_tag = [NSData dataWithBytes:[tag UTF8String] length:[tag length]];
	
	// Delete any old lingering key with the same tag
	NSMutableDictionary *publicKey = [[NSMutableDictionary alloc] init];
	[publicKey setObject:(__bridge id) kSecClassKey forKey:(__bridge id)kSecClass];
	[publicKey setObject:(__bridge id) kSecAttrKeyTypeRSA forKey:(__bridge id)kSecAttrKeyType];
	[publicKey setObject:d_tag forKey:(__bridge id)kSecAttrApplicationTag];
	SecItemDelete((__bridge CFDictionaryRef)publicKey);
	
	// Add persistent version of the key to system keychain
	[publicKey setObject:data forKey:(__bridge id)kSecValueData];
	[publicKey setObject:(__bridge id) kSecAttrKeyClassPublic forKey:(__bridge id)
	 kSecAttrKeyClass];
	[publicKey setObject:[NSNumber numberWithBool:YES] forKey:(__bridge id)
	 kSecReturnPersistentRef];
	
	CFTypeRef persistKey = nil;
	OSStatus status = SecItemAdd((__bridge CFDictionaryRef)publicKey, &amp;persistKey);
	if (persistKey != nil){
		CFRelease(persistKey);
	}
	if ((status != noErr) &amp;&amp; (status != errSecDuplicateItem)) {
		return nil;
	}

	[publicKey removeObjectForKey:(__bridge id)kSecValueData];
	[publicKey removeObjectForKey:(__bridge id)kSecReturnPersistentRef];
	[publicKey setObject:[NSNumber numberWithBool:YES] forKey:(__bridge id)kSecReturnRef];
	[publicKey setObject:(__bridge id) kSecAttrKeyTypeRSA forKey:(__bridge id)kSecAttrKeyType];
	
	// Now fetch the SecKeyRef version of the key
	SecKeyRef keyRef = nil;
	status = SecItemCopyMatching((__bridge CFDictionaryRef)publicKey, (CFTypeRef *)&amp;keyRef);
	if(status != noErr){
		return nil;
	}
	return keyRef;
}

+ (SecKeyRef)addPrivateKey:(NSString *)key{
	NSRange spos;
	NSRange epos;
	spos = [key rangeOfString:@&quot;-----BEGIN RSA PRIVATE KEY-----&quot;];
	if(spos.length &gt; 0){
		epos = [key rangeOfString:@&quot;-----END RSA PRIVATE KEY-----&quot;];
	}else{
		spos = [key rangeOfString:@&quot;-----BEGIN PRIVATE KEY-----&quot;];
		epos = [key rangeOfString:@&quot;-----END PRIVATE KEY-----&quot;];
	}
	if(spos.location != NSNotFound &amp;&amp; epos.location != NSNotFound){
		NSUInteger s = spos.location + spos.length;
		NSUInteger e = epos.location;
		NSRange range = NSMakeRange(s, e-s);
		key = [key substringWithRange:range];
	}
	key = [key stringByReplacingOccurrencesOfString:@&quot;\\r&quot; withString:@&quot;&quot;];
	key = [key stringByReplacingOccurrencesOfString:@&quot;\\n&quot; withString:@&quot;&quot;];
	key = [key stringByReplacingOccurrencesOfString:@&quot;\\t&quot; withString:@&quot;&quot;];
	key = [key stringByReplacingOccurrencesOfString:@&quot; &quot;  withString:@&quot;&quot;];

	// This will be base64 encoded, decode it.
	NSData *data = base64_decode(key);
	data = [RSA stripPrivateKeyHeader:data];
	if(!data){
		return nil;
	}

	//a tag to read/write keychain storage
	NSString *tag = @&quot;RSAUtil_PrivKey&quot;;
	NSData *d_tag = [NSData dataWithBytes:[tag UTF8String] length:[tag length]];

	// Delete any old lingering key with the same tag
	NSMutableDictionary *privateKey = [[NSMutableDictionary alloc] init];
	[privateKey setObject:(__bridge id) kSecClassKey forKey:(__bridge id)kSecClass];
	[privateKey setObject:(__bridge id) kSecAttrKeyTypeRSA forKey:(__bridge id)kSecAttrKeyType];
	[privateKey setObject:d_tag forKey:(__bridge id)kSecAttrApplicationTag];
	SecItemDelete((__bridge CFDictionaryRef)privateKey);

	// Add persistent version of the key to system keychain
	[privateKey setObject:data forKey:(__bridge id)kSecValueData];
	[privateKey setObject:(__bridge id) kSecAttrKeyClassPrivate forKey:(__bridge id)
	 kSecAttrKeyClass];
	[privateKey setObject:[NSNumber numberWithBool:YES] forKey:(__bridge id)
	 kSecReturnPersistentRef];

	CFTypeRef persistKey = nil;
	OSStatus status = SecItemAdd((__bridge CFDictionaryRef)privateKey, &amp;persistKey);
	if (persistKey != nil){
		CFRelease(persistKey);
	}
	if ((status != noErr) &amp;&amp; (status != errSecDuplicateItem)) {
		return nil;
	}

	[privateKey removeObjectForKey:(__bridge id)kSecValueData];
	[privateKey removeObjectForKey:(__bridge id)kSecReturnPersistentRef];
	[privateKey setObject:[NSNumber numberWithBool:YES] forKey:(__bridge id)kSecReturnRef];
	[privateKey setObject:(__bridge id) kSecAttrKeyTypeRSA forKey:(__bridge id)kSecAttrKeyType];

	// Now fetch the SecKeyRef version of the key
	SecKeyRef keyRef = nil;
	status = SecItemCopyMatching((__bridge CFDictionaryRef)privateKey, (CFTypeRef *)&amp;keyRef);
	if(status != noErr){
		return nil;
	}
	return keyRef;
}

/* START: Encryption &amp; Decryption with RSA private key */

+ (NSData *)encryptData:(NSData *)data withKeyRef:(SecKeyRef) keyRef isSign:(BOOL)isSign {
	const uint8_t *srcbuf = (const uint8_t *)[data bytes];
	size_t srclen = (size_t)data.length;
	
	size_t block_size = SecKeyGetBlockSize(keyRef) * sizeof(uint8_t);
	void *outbuf = malloc(block_size);
	size_t src_block_size = block_size - 11;
	
	NSMutableData *ret = [[NSMutableData alloc] init];
	for(int idx=0; idx&lt;srclen; idx+=src_block_size){
		//NSLog(@&quot;%d/%d block_size: %d&quot;, idx, (int)srclen, (int)block_size);
		size_t data_len = srclen - idx;
		if(data_len &gt; src_block_size){
			data_len = src_block_size;
		}
		
		size_t outlen = block_size;
		OSStatus status = noErr;
        
        if (isSign) {
            status = SecKeyRawSign(keyRef,
                                   kSecPaddingPKCS1,
                                   srcbuf + idx,
                                   data_len,
                                   outbuf,
                                   &amp;outlen
                                   );
        } else {
            status = SecKeyEncrypt(keyRef,
                                   kSecPaddingPKCS1,
                                   srcbuf + idx,
                                   data_len,
                                   outbuf,
                                   &amp;outlen
                                   );
        }
		if (status != 0) {
			NSLog(@&quot;SecKeyEncrypt fail. Error Code: %d&quot;, status);
			ret = nil;
			break;
		}else{
			[ret appendBytes:outbuf length:outlen];
		}
	}
	
	free(outbuf);
	CFRelease(keyRef);
	return ret;
}

+ (NSString *)encryptString:(NSString *)str privateKey:(NSString *)privKey{
	NSData *data = [RSA encryptData:[str dataUsingEncoding:NSUTF8StringEncoding] privateKey:privKey];
	NSString *ret = base64_encode_data(data);
	return ret;
}

+ (NSData *)encryptData:(NSData *)data privateKey:(NSString *)privKey{
	if(!data || !privKey){
		return nil;
	}
	SecKeyRef keyRef = [RSA addPrivateKey:privKey];
	if(!keyRef){
		return nil;
	}
	return [RSA encryptData:data withKeyRef:keyRef isSign:YES];
}

+ (NSData *)decryptData:(NSData *)data withKeyRef:(SecKeyRef) keyRef{
	const uint8_t *srcbuf = (const uint8_t *)[data bytes];
	size_t srclen = (size_t)data.length;
	
	size_t block_size = SecKeyGetBlockSize(keyRef) * sizeof(uint8_t);
	UInt8 *outbuf = malloc(block_size);
	size_t src_block_size = block_size;
	
	NSMutableData *ret = [[NSMutableData alloc] init];
	for(int idx=0; idx&lt;srclen; idx+=src_block_size){
		//NSLog(@&quot;%d/%d block_size: %d&quot;, idx, (int)srclen, (int)block_size);
		size_t data_len = srclen - idx;
		if(data_len &gt; src_block_size){
			data_len = src_block_size;
		}
		
		size_t outlen = block_size;
		OSStatus status = noErr;
		status = SecKeyDecrypt(keyRef,
							   kSecPaddingNone,
							   srcbuf + idx,
							   data_len,
							   outbuf,
							   &amp;outlen
							   );
		if (status != 0) {
			NSLog(@&quot;SecKeyEncrypt fail. Error Code: %d&quot;, status);
			ret = nil;
			break;
		}else{
			//the actual decrypted data is in the middle, locate it!
			int idxFirstZero = -1;
			int idxNextZero = (int)outlen;
			for ( int i = 0; i &lt; outlen; i++ ) {
				if ( outbuf[i] == 0 ) {
					if ( idxFirstZero &lt; 0 ) {
						idxFirstZero = i;
					} else {
						idxNextZero = i;
						break;
					}
				}
			}
			
			[ret appendBytes:&amp;outbuf[idxFirstZero+1] length:idxNextZero-idxFirstZero-1];
		}
	}
	
	free(outbuf);
	CFRelease(keyRef);
	return ret;
}


+ (NSString *)decryptString:(NSString *)str privateKey:(NSString *)privKey{
	NSData *data = [[NSData alloc] initWithBase64EncodedString:str options:NSDataBase64DecodingIgnoreUnknownCharacters];
	data = [RSA decryptData:data privateKey:privKey];
	NSString *ret = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
	return ret;
}

+ (NSData *)decryptData:(NSData *)data privateKey:(NSString *)privKey{
	if(!data || !privKey){
		return nil;
	}
	SecKeyRef keyRef = [RSA addPrivateKey:privKey];
	if(!keyRef){
		return nil;
	}
	return [RSA decryptData:data withKeyRef:keyRef];
}

/* END: Encryption &amp; Decryption with RSA private key */

/* START: Encryption &amp; Decryption with RSA public key */

+ (NSString *)encryptString:(NSString *)str publicKey:(NSString *)pubKey{
	NSData *data = [RSA encryptData:[str dataUsingEncoding:NSUTF8StringEncoding] publicKey:pubKey];
	NSString *ret = base64_encode_data(data);
	return ret;
}

+ (NSData *)encryptData:(NSData *)data publicKey:(NSString *)pubKey{
	if(!data || !pubKey){
		return nil;
	}
	SecKeyRef keyRef = [RSA addPublicKey:pubKey];
	if(!keyRef){
		return nil;
	}
	return [RSA encryptData:data withKeyRef:keyRef isSign:NO];
}

+ (NSString *)decryptString:(NSString *)str publicKey:(NSString *)pubKey{
	NSData *data = [[NSData alloc] initWithBase64EncodedString:str options:NSDataBase64DecodingIgnoreUnknownCharacters];
	data = [RSA decryptData:data publicKey:pubKey];
	NSString *ret = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
	return ret;
}

+ (NSData *)decryptData:(NSData *)data publicKey:(NSString *)pubKey{
	if(!data || !pubKey){
		return nil;
	}
	SecKeyRef keyRef = [RSA addPublicKey:pubKey];
	if(!keyRef){
		return nil;
	}
	return [RSA decryptData:data withKeyRef:keyRef];
}

/* END: Encryption &amp; Decryption with RSA public key */
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br><span class="line-number">369</span><br><span class="line-number">370</span><br><span class="line-number">371</span><br><span class="line-number">372</span><br><span class="line-number">373</span><br><span class="line-number">374</span><br><span class="line-number">375</span><br><span class="line-number">376</span><br><span class="line-number">377</span><br><span class="line-number">378</span><br><span class="line-number">379</span><br><span class="line-number">380</span><br><span class="line-number">381</span><br><span class="line-number">382</span><br><span class="line-number">383</span><br><span class="line-number">384</span><br><span class="line-number">385</span><br><span class="line-number">386</span><br><span class="line-number">387</span><br><span class="line-number">388</span><br><span class="line-number">389</span><br><span class="line-number">390</span><br><span class="line-number">391</span><br><span class="line-number">392</span><br><span class="line-number">393</span><br><span class="line-number">394</span><br><span class="line-number">395</span><br><span class="line-number">396</span><br><span class="line-number">397</span><br><span class="line-number">398</span><br><span class="line-number">399</span><br><span class="line-number">400</span><br><span class="line-number">401</span><br></div></div><p><strong>\u53C2\u8003\uFF1A</strong></p>`,3),Sn={href:"http://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html",target:"_blank",rel:"noopener noreferrer"},dn=s("RSA\u7B97\u6CD5\u539F\u7406"),gn=r(`<hr><h3 id="\u5176\u4ED6" tabindex="-1"><a class="header-anchor" href="#\u5176\u4ED6" aria-hidden="true">#</a> \u5176\u4ED6</h3><h4 id="crc" tabindex="-1"><a class="header-anchor" href="#crc" aria-hidden="true">#</a> CRC</h4><blockquote><p>CRC\u5373<strong>\u5FAA\u73AF\u5197\u4F59\u6821\u9A8C\u7801</strong>\uFF08Cyclic Redundancy Check [1] \uFF09\uFF1A\u662F\u6570\u636E\u901A\u4FE1\u9886\u57DF\u4E2D\u6700\u5E38\u7528\u7684\u4E00\u79CD\u67E5\u9519\u6821\u9A8C\u7801\uFF0C\u5176\u7279\u5F81\u662F\u4FE1\u606F\u5B57\u6BB5\u548C\u6821\u9A8C\u5B57\u6BB5\u7684\u957F\u5EA6\u53EF\u4EE5\u4EFB\u610F\u9009\u5B9A\u3002</p><p>\u5FAA\u73AF\u5197\u4F59\u68C0\u67E5\uFF08CRC\uFF09\u662F\u4E00\u79CD\u6570\u636E\u4F20\u8F93\u68C0\u9519\u529F\u80FD\uFF0C\u5BF9\u6570\u636E\u8FDB\u884C\u591A\u9879\u5F0F\u8BA1\u7B97\uFF0C\u5E76\u5C06\u5F97\u5230\u7684\u7ED3\u679C\u9644\u5728\u5E27\u7684\u540E\u9762\uFF0C\u63A5\u6536\u8BBE\u5907\u4E5F\u6267\u884C\u7C7B\u4F3C\u7684\u7B97\u6CD5\uFF0C\u4EE5\u4FDD\u8BC1\u6570\u636E\u4F20\u8F93\u7684\u6B63\u786E\u6027\u548C\u5B8C\u6574\u6027\u3002</p></blockquote><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>
#import &lt;zlib.h&gt;

ZEXTERN uLong ZEXPORT crc32   OF((uLong crc, const Bytef *buf, uInt len));
/*
     Update a running CRC-32 with the bytes buf[0..len-1] and return the
   updated CRC-32.  If buf is Z_NULL, this function returns the required
   initial value for the crc.  Pre- and post-conditioning (one&#39;s complement) is
   performed within this function so it shouldn&#39;t be done by the application.

   Usage example:

     uLong crc = crc32(0L, Z_NULL, 0);

     while (read_buffer(buffer, length) != EOF) {
       crc = crc32(crc, buffer, length);
     }
     if (crc != original_crc) error();
*/

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><strong>\u53C2\u8003</strong></p>`,6),hn={href:"http://blog.163.com/du_minchao@126/blog/static/107495394201075114028606/",target:"_blank",rel:"noopener noreferrer"},yn=s("CRC\u7684\u6821\u9A8C\u539F\u7406 "),_n={href:"https://www.cnblogs.com/esestt/archive/2007/08/09/848856.html",target:"_blank",rel:"noopener noreferrer"},fn=s("\u7B97\u6CD5\u539F\u7406"),kn={href:"https://jin-yang.github.io/post/security-encryption-introduce.html",target:"_blank",rel:"noopener noreferrer"},Nn=s("\u52A0\u5BC6\u7B97\u6CD5\u7B80\u4ECB");function Cn(An,En){const e=t("ExternalLinkIcon");return l(),i(p,null,[u,n("p",null,[n("a",o,[m,a(e)])]),S,n("p",null,[n("a",d,[g,a(e)])]),n("p",null,[n("a",h,[y,a(e)])]),n("p",null,[n("a",_,[f,a(e)])]),n("p",null,[n("a",k,[N,a(e)])]),C,n("blockquote",null,[n("p",null,[A,E,n("a",D,[K,a(e)]),n("a",x,[R,a(e)]),v,n("a",H,[q,a(e)]),w,n("a",T,[z,a(e)]),B,n("a",F,[O,a(e)]),I,n("a",U,[G,a(e)]),M,n("a",L,[W,a(e)]),P,n("a",j,[V,a(e)]),Z,n("a",Y,[X,a(e)]),J,n("a",Q,[$,a(e)]),nn,n("a",sn,[en,a(e)]),an,n("a",rn,[tn,a(e)]),ln])]),pn,n("p",null,[bn,cn,n("a",un,[on,a(e)])]),mn,n("p",null,[n("a",Sn,[dn,a(e)])]),gn,n("p",null,[n("a",hn,[yn,a(e)])]),n("p",null,[n("a",_n,[fn,a(e)])]),n("p",null,[n("a",kn,[Nn,a(e)])])],64)}var xn=b(c,[["render",Cn]]);export{xn as default};
